(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{6210:(e,t,o)=>{"use strict";o.d(t,{Ex:()=>i,gf:()=>r,v$:()=>l});let i=(e,t)=>{localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t)},s=()=>localStorage.getItem("access_token"),n=()=>localStorage.getItem("refresh_token"),r=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},a=async()=>{let e=n();if(!e)throw Error("No refresh token available");let t=await fetch("http://localhost:5000/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw Error("Failed to refresh token");let o=await t.json();return i(o.access,e),o.access},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s(),i={...t.headers,"Content-Type":"application/json"};o&&(i.Authorization="Bearer ".concat(o));try{let s=await fetch(e,{...t,headers:i});return 401===s.status&&o&&(o=await a(),i.Authorization="Bearer ".concat(o),s=await fetch(e,{...t,headers:i})),s}catch(e){throw console.error("Fetch error:",e),e}}},8591:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>f});var i=o(5155),s=o(2115),n=o(5695),r=o(700),a=o(7217),l=o(2302),c=o(4581),d=o(579),h=o(4915),u=o(3613),v=o(8534),g=o(2110),m=o(1218),x=o(6632),p=o(6210);let y=["Digestive Issues (Indigestion, Bloating, Acidity)","Stress and Anxiety","Sleep Problems (Insomnia)","Joint Pain and Inflammation","Skin Issues (Acne, Eczema, Dryness)","Weak Immunity","High Blood Pressure (Hypertension)","Diabetes (Madhumeha)","Respiratory Issues (Asthma, Bronchitis, Allergies)","Hair Fall and Thinning","Fatigue and Low Energy"];function f(){var e,t,o,f,A;let[j,S]=(0,s.useState)(null),[_,b]=(0,s.useState)(!0),[k,w]=(0,s.useState)([]),[I,E]=(0,s.useState)(""),N=(0,n.useRouter)();(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,p.v$)("http://localhost:5000/api/user-profile");if(!e.ok)throw Error("Not logged in");let t=await e.json();S(t),w(t.health_concerns||[])}catch(e){E("Please log in to view your profile."),N.push("/login")}finally{b(!1)}})()},[N]);let P=e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},C=async()=>{if(j)try{if(!(await (0,p.v$)("http://localhost:5000/api/user-profile",{method:"POST",body:JSON.stringify({health_concerns:k})})).ok)throw Error("Failed to update health concerns");S({...j,health_concerns:k}),E(""),alert("Health concerns updated successfully!")}catch(e){E("Failed to update health concerns: "+e.message)}},B=async()=>{try{let e=localStorage.getItem("refresh_token");if((await (0,p.v$)("http://localhost:5000/api/auth/logout",{method:"POST",body:JSON.stringify({refresh:e})})).ok)(0,p.gf)(),N.push("/login");else throw Error("Logout failed")}catch(e){E("Error logging out: "+e.message)}};return _?(0,i.jsx)(r.A,{children:"Loading..."}):(0,i.jsxs)(a.A,{maxWidth:"md",sx:{py:8},children:[(0,i.jsx)(r.A,{variant:"h4",align:"center",gutterBottom:!0,children:"Profile"}),I&&(0,i.jsx)(l.A,{severity:"error",sx:{mb:2},children:I}),j&&(0,i.jsxs)(c.A,{sx:{mb:4},children:[(0,i.jsxs)(r.A,{variant:"h6",children:["Username: ",j.username]}),(0,i.jsxs)(r.A,{variant:"body1",children:["Premium: ",j.is_premium?"Yes":"No"]}),j.paypal_subscription_id&&(0,i.jsxs)(r.A,{variant:"body2",children:["Subscription ID: ",j.paypal_subscription_id]}),(0,i.jsxs)(r.A,{variant:"body1",children:["Solutions Submitted: ",null===(e=j.submitted_solutions)||void 0===e?void 0:e.length]}),(0,i.jsxs)(r.A,{variant:"body1",children:["Solutions Favorited: ",null===(t=j.favorite_solutions)||void 0===t?void 0:t.length]}),(0,i.jsxs)(r.A,{variant:"body1",children:["Interactions: ",j.interactions_count]}),(0,i.jsxs)(c.A,{sx:{mt:4},children:[(0,i.jsx)(r.A,{variant:"h6",children:"Your Health Concerns"}),(0,i.jsx)(d.A,{children:y.map(e=>(0,i.jsx)(h.A,{control:(0,i.jsx)(u.A,{checked:k.includes(e),onChange:()=>P(e)}),label:e},e))}),(0,i.jsx)(v.A,{variant:"contained",sx:{bgcolor:"#388e3c",mt:2},onClick:C,children:"Save Concerns"})]}),(0,i.jsx)(v.A,{variant:"contained",color:"secondary",onClick:B,sx:{mt:2},children:"Logout"})]}),(0,i.jsx)(r.A,{variant:"h5",gutterBottom:!0,children:"Your Submitted Solutions"}),(null==j?void 0:null===(o=j.submitted_solutions)||void 0===o?void 0:o.length)?(0,i.jsx)(g.A,{container:!0,spacing:4,children:null==j?void 0:j.submitted_solutions.map(e=>(0,i.jsx)(g.A,{size:6,children:(0,i.jsx)(m.A,{children:(0,i.jsxs)(x.A,{children:[(0,i.jsxs)(r.A,{variant:"h6",children:[e.title," (",e.solution_id,")"]}),(0,i.jsx)(r.A,{variant:"body2",color:"textSecondary",children:e.description})]})})},e.id))}):(0,i.jsx)(r.A,{children:"No solutions submitted yet."}),(0,i.jsx)(r.A,{variant:"h5",gutterBottom:!0,sx:{mt:4},children:"Favorite Solutions"}),(null==j?void 0:null===(f=j.favorite_solutions)||void 0===f?void 0:f.length)?(0,i.jsx)(g.A,{container:!0,spacing:4,children:null==j?void 0:null===(A=j.favorite_solutions)||void 0===A?void 0:A.map(e=>(0,i.jsx)(g.A,{size:6,children:(0,i.jsx)(m.A,{children:(0,i.jsxs)(x.A,{children:[(0,i.jsxs)(r.A,{variant:"h6",children:[e.title," (",e.solution_id,")"]}),(0,i.jsx)(r.A,{variant:"body2",color:"textSecondary",children:e.description})]})})},e.id))}):(0,i.jsx)(r.A,{children:"No favorite solutions yet."})]})}},9775:(e,t,o)=>{Promise.resolve().then(o.bind(o,8591))}},e=>{var t=t=>e(e.s=t);e.O(0,[765,698,214,381,441,684,358],()=>t(9775)),_N_E=e.O()}]);